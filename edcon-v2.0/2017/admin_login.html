<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
    <script src="js/jquery-3.1.1.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
    <style type="text/css">
        body {
            background-color: #3a4563;
        }

        #login:hover {
            background-color: red;
        }
    </style>
</head>
<body>
<div style="width: 220px;height: 155px;margin: auto;position: absolute;left: 50%;top: 44%;margin-left: -110px;margin-top: -75px">
    <label style="width: 100%;text-align: center;color: #fff;font-size: 26px;">会议后台登录</label>
    <input id="act" class="form-control" style="height: 40px;margin-top: 7px;" type="text" placeholder="请输入账号" name=""
           id="" value=""/>
    <input id="pwd" class="form-control" style="height: 40px;margin-top: 7px;font-size: 14px;" type="password"
           placeholder="请输入密码" name="" id="" value=""/>
    <select id="mysql" style="width: 100%;margin-top: 7px; display: inline-block;" class="form-control">
        <option value="eurp">欧洲数据库</option>
        <option value="visa">亚洲数据库</option>
    </select>
    <button id="login"
            style="background-color: #788ded;height: 50px;width: 100%;margin-top: 7px;font-size: 18px;border: 1px solid rgba(0, 0, 0, .49);text-shadow: 0px -1px 0px #5b6ddc;outline: none;color: #fff;border-radius: 10px;">
        登录
    </button>
</div>
</body>
<script type="text/javascript">
    $(function () {
        if (localStorage.getItem('meeting_act') && localStorage.getItem('meeting_pwd')) {
            document.getElementById("act").value = localStorage.getItem('meeting_act');
            document.getElementById("pwd").value = localStorage.getItem('meeting_pwd');
        }

        document.getElementById("login").addEventListener('click', function () {

            var act = document.getElementById("act").value;
            var pwd = document.getElementById("pwd").value;

            if (act == "" || pwd == "") {
                alert('账号密码不能为空');
            } else {
                document.getElementById("login").innerText = "正在登录...";
                document.getElementById("login").disabled = "disabled";
                $.ajax({
                    type: "post",
                    data: {
                        admin: act,
                        pwd: pwd
                    },
                    url: "http://www.ethcloud.net/FranceWebsite/handle/adminLogin.php",
                    dataType: 'json',
                    timeout: 30000,
                    success: function (data) {
                        if (data.code == "200") {
                            var mysql = $('#mysql').val();
                            if (mysql == "eurp") {
                                $.ajax({
                                    type: "post",
                                    url: "http://www.ethcloud.net/FranceWebsite/common/selectDB.php",
                                    data: {
                                        db: "2"
                                    },
                                    dataType: 'json',
                                    timeout: 10000,
                                    success: function (data) {
                                        if (data.code == '200') {
                                            console.log("欧洲数据库");
                                            localStorage.setItem('meeting_act', act);
                                            localStorage.setItem('meeting_pwd', pwd);
                                            sessionStorage.setItem('meeting_act', act);
                                            sessionStorage.setItem('metting_pwd', pwd);
                                            location.href = 'admin.html';
                                        } else {

                                            console.log(JSON.stringify(data));
                                        }
                                    },
                                    error: function (xhr, type, errorThrown) {


                                    }
                                });
                            } else {
                                $.ajax({
                                    type: "post",
                                    url: "http://www.ethcloud.net/FranceWebsite/common/selectDB.php",
                                    data: {
                                        db: "1"
                                    },
                                    dataType: 'json',
                                    timeout: 10000,
                                    success: function (data) {
                                        if (data.code == '200') {
                                            console.log("亚洲数据库");
                                            localStorage.setItem('meeting_act', act);
                                            localStorage.setItem('meeting_pwd', pwd);
                                            sessionStorage.setItem('meeting_act', act);
                                            sessionStorage.setItem('metting_pwd', pwd);
                                            location.href = 'admin.html';
                                        } else {

                                            console.log(JSON.stringify(data));
                                        }
                                    },
                                    error: function (xhr, type, errorThrown) {


                                    }
                                });
                            }
//								sessionStorage.setItem('meeting_act',act);
//								sessionStorage.setItem('metting_pwd',pwd);
//								location.href='admin.html';
//								console.log(JSON.stringify(data));
                        } else {
                            document.getElementById("login").innerText = "登录";
                            document.getElementById("login").disabled = "";
                            alert(data.data);
                            console.log(JSON.stringify(data));
                        }
                    },
                    error: function (xhr, type, errorThrown) {


                    }
                });
            }

        });
    });
</script>
</html>
